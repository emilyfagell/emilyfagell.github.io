<! DOCTYPE html>
<html>
  <head>
    <title>Literacy and Voter Turnout by U.S. State</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
   integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
   crossorigin=""/>
     <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
   integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
   crossorigin=""></script>
    <style>
      #map { height: 600px; width: 800px; margin-left: auto; margin-right: auto;}
      html, body {height: 100%; margin-left: auto; margin-right: auto; padding: 0; }
      #buttons { padding: 10px; margin-left: auto; margin-right: auto; background: #ADD8E6; }
.legend {
    line-height: 18px;
    color: #555;
}
.legend i {
    width: 18px;
    height: 18px;
    float: left;
    margin-right: 8px;
    opacity: 0.7;
}
    </style>
    
    <script>
$(document).ready(function(){
      var literacyVisible = true;
  
      var OpenStreetMap_HOT = L.tileLayer ('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png',
                                           { maxZoom: 19,
                                               attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, Tiles courtesy of <a href=http://hot.osm.org">HOT OSM</a>' 
      });

      var USGS_USTopo = L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer/tile/{z}/{y}/{x}', {
	maxZoom: 20,
	attribution: 'Tiles courtesy of the <a href="https://usgs.gov/">U.S. Geological Survey</a>'
});
// sourced from https://leafletjs.com/examples/choropleth/
function getColor(d) {
    return d < 250 ? '#edf8fb' :
           d < 255  ? '#ccece6' :
           d < 260  ? '#99d8c9' :
	   d < 265  ? '#66c2a4' :
	   d < 270  ? '#41ae76' :
	   d < 275  ? '#238b45' :
	   d < 280  ? '#005824' :
	    "#000000";
	    }

function style(feature) {
    return {
        fillColor: getColor(feature.properties.Indirect_Estimate),
        weight: 2,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.7
    };
}


	    
         var map = L.map('map', {
           center: [ 39.8355, -99.0909 ],
           zoom: 4
         });

	var baseMaps = { "OSM" : OpenStreetMap_HOT,
			"USGS" : USGS_USTopo

		       }		

	L.control.layers(baseMaps).addTo(map);

var response = $.ajax({
    url: "literacy.geojson",
    dataType: "json",
    success: console.log("literacy data loaded!"),
    error: function(xhr) {
	    alert(xhr.StatusText);
    }
});

$.when(response).done(function() {	
	
 	var literacyLayer = L.geoJson(response.responseJSON,
                   { onEachFeature: function(feature, layer) {
                	  layer.bindPopup("<b>Estimated Literacy Rate: " + 
               	   	feature.properties.Indirect_Estimate + "</b>");
               	 },
		    style: style
                	  }).addTo(map);
	 $("#toggleLiteracy").show();
 	 $("#toggleLiteracy").click( function() {
   	 if (literacyVisible) {
    	  literacyVisible = false;
     	 literacyLayer.removeFrom(map);
  	  } else {
   		 literacyVisible = true;
 	   literacyLayer.addTo(map);
   	  }
 	})

var legend = L.control({position: 'bottomright'});
legend.onAdd = function (literacyLayer) {
    var div = L.DomUtil.create('div', 'info legend'),
        grades = [250, 255, 260, 265, 270, 275, 280],
        labels = [];

    // loop through our density intervals and generate a label with a colored square for each interval
    for (var i = 0; i < grades.length; i++) {
        div.innerHTML +=
            '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
    }

    return div;
};

legend.addTo(map);
       })

})
     
    </script>
  </head>
  <body>
    <h1>Literacy and Voter Turnout by U.S. State</h1>
    <p> Throughout history, literacy and the vote have been closely intertwined. Until 1965 in the South (and 1970 in the rest of the nation), the U.S. government required individuals to pass a literacy test to vote. Theoretically implemented to ensure "an educated and informed electorate," the tests in practice blocked many Black people, poor people, and immigrants from the ballot box (National Museum of American History). </p>
    <div id="map"></div>
    <div id="buttons">
      <button id="toggleLiteracy" hidden>Toggle the Literacy Layer.</button>
    </div>
  </body>
</html>
