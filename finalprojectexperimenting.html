<! DOCTYPE html>
<html>
  <head>
    <title>Literacy and Voter Turnout by U.S. State</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
   integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
   crossorigin=""/>
     <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
   integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
   crossorigin=""></script>
    <style>
	p { text-align: justify;
       font-family: roboto, georgia;
      }
      #mapLiteracy { height: 600px; width: 1000px; margin-left: auto; margin-right: auto;}
      html, body {height: 100%; margin-left: 100px; margin-right: 100px; margin-top: 25px; padding: 0; background: #BCD2E8}
      #buttons { padding: 10px; margin-left: auto; margin-right: auto; background: #ADD8E6; }
      #mapTurnout { height: 600px; width: 1000px; margin-left: auto; margin-right: auto;}
      html, body {height: 100%; margin-left: 100px; margin-right: 100px; margin-top: 25px; padding: 0; background: #BCD2E8}
.legendLiteracy {
    line-height: 18px;
    color: #555;
}
.legendLiteracy i {
    width: 18px;
    height: 18px;
    float: left;
    margin-right: 8px;
    opacity: 0.7;
}
.legendTurnout {
    line-height: 18px;
    color: #555;
}
.legendTurnout i {
    width: 18px;
    height: 18px;
    float: left;
    margin-right: 8px;
    opacity: 0.7;
}
    </style>
    
    <script>
$(document).ready(function(){
      var literacyVisible = true;
      var turnoutVisible = true;
      var OpenStreetMap_HOT = L.tileLayer ('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png',
                                           { maxZoom: 19,
                                               attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, Tiles courtesy of <a href=http://hot.osm.org">HOT OSM</a>' 
      });

      var USGS_USTopo = L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer/tile/{z}/{y}/{x}', {
	maxZoom: 20,
	attribution: 'Tiles courtesy of the <a href="https://usgs.gov/">U.S. Geological Survey</a>'
});
// sourced from https://leafletjs.com/examples/choropleth/
function getColorLiteracy(d) {
    return d < 250 ? '#edf8fb' :
           d < 255  ? '#ccece6' :
           d < 260  ? '#99d8c9' :
	   d < 265  ? '#66c2a4' :
	   d < 270  ? '#41ae76' :
	   d < 275  ? '#238b45' :
	   d < 280  ? '#005824' :
	    "#000000";
	    }

function style(feature) {
    return {
        fillColor: getColorLiteracy(feature.properties.Indirect_Estimate),
        weight: 2,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.7
    };
}


	    
         var mapLiteracy = L.map('mapLiteracy', {
           center: [ 39.8355, -99.0909 ],
           zoom: 4
         });

	var mapTurnout = L.map('mapTurnout', {
           center: [ 39.8355, -99.0909 ],
           zoom: 4
         });

	var baseMaps = { "USGS" : USGS_USTopo,
			"OSM" : OpenStreetMap_HOT			

		       }		
	USGS_USTopo.addTo(mapLiteracy);
	L.control.layers(baseMaps).addTo(mapLiteracy);

	USGS_USTopo.addTo(mapTurnout);
	L.control.layers(baseMaps).addTo(mapTurnout);

var response = $.ajax({
    url: "literacy.geojson",
    dataType: "json",
    success: console.log("literacy data loaded!"),
    error: function(xhr) {
	    alert(xhr.StatusText);
    } });
var response = $.ajax({
    url: "turnout.geojson",
    dataType: "json",
    success: console.log("turnout data loaded!"),
    error: function(xhr) {
	    alert(xhr.StatusText);
    }
});

$.when(response).done(function() {	
	
 	var literacyLayer = L.geoJson(response.responseJSON,
                   { onEachFeature: function(feature, layer) {
                	  layer.bindPopup("<b>Estimated Literacy Rate: " + 
               	   	feature.properties.Indirect_Estimate + "</b>");
               	 },
		    style: style
                	  }).addTo(mapLiteracy);
	 $("#toggleLiteracy").show();
 	 $("#toggleLiteracy").click( function() {
   	 if (literacyVisible) {
    	  literacyVisible = false;
     	 literacyLayer.removeFrom(mapLiteracy);
  	  } else {
   		 literacyVisible = true;
 	   literacyLayer.addTo(mapLiteracy);
   	  }
 	})

	 var turnoutLayer = L.geoJson(response.responseJSON,
                   { onEachFeature: function(feature, layer) {
                	  layer.bindPopup("<b>Voter Turnout (Total Ballots): " + 
               	   	feature.properties.VEP_Turnout_Rate__Total_Ballots + "</b><br>" +
                  "Voter Turnout (Highest Office): " + feature.properties.VEP_Turnout_Rate__Highest_Offic);
                },
		    style: style
                	  }).addTo(mapTurnout);
	 $("#toggleTurnout").show();
 	 $("#toggleTurnout").click( function() {
   	 if (turnoutVisible) {
    	  turnoutVisible = false;
     	 turnoutLayer.removeFrom(mapTurnout);
  	  } else {
   		 turnoutVisible = true;
 	   turnoutLayer.addTo(mapTurnout);
   	  }
 	})

var legendLiteracy = L.control({position: 'bottomright'});
legend.onAdd = function (literacyLayer) {
    var div = L.DomUtil.create('div', 'info legend'),
        grades = [250, 255, 260, 265, 270, 275, 280],
        labels = [];

    // loop through our density intervals and generate a label with a colored square for each interval
    for (var i = 0; i < grades.length; i++) {
        div.innerHTML +=
            '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
    }

    return div;
};

legend.addTo(mapLiteracy);
       })

})
     
    </script>
  </head>
  <body>
<h1 style="font-family: roboto, georgia; margin-top: 50px;">Literacy and Voter Turnout by U.S. State</h1>
  <h3 style="font-family: roboto, georgia;">Background: Literacy as a Political Tool</h3>
    <p style="font-family: roboto, georgia;"> Throughout history, literacy and the vote have been closely intertwined. Until 1965 in the South (and 1970 in the rest of the nation), the U.S. government required individuals to pass a literacy test to vote. Theoretically implemented to ensure "an educated and informed electorate," the tests in practice blocked many Black people, poor people, and immigrants from the ballot box (National Museum of American History). </p>
    <p style="font-family: roboto, georgia;"> Although the Voting Rights Act outlawed the tests in 1965 and 1970, literacy nonetheless continues to affect an individual's ability and likelihood to vote. According the the National Institutes of Health, educational attainment (of which literacy is a key factor) "is among the strongest correlates of voter turnout." Moreover, recent laws (implemented in 2020) limit the assistance voters can receive at the ballot box â€” thus hindering access for voters with disabilities or low literacy scores (PBS). </p>
    <p style="font-family: roboto, georgia;"> The maps below demonstrates average literacy scale scores (measured on a scale of 1-500) of U.S. States (2012/2014/2017) and voter turnout in the 2020 elections.  </p>
<h3 style="font-family: roboto;">Figure 1: U.S. Average Literacy Scale Scores (2012/2014/2017) </h3>
	  <div id="mapLiteracy"></div>
    <div id="buttons">
      <button id="toggleLiteracy" hidden>Toggle the Literacy Layer.</button>
    </div>
<p>Source: U.S. Department of Education, National Center for Education Statistics, U.S. Program for the International Assessment of Adult Competencies (PIAAC), 2012/2014/2017.</p>
  <div id="mapTurnout"></div>
  </body>
</html>
